// local/offline testing
const data = [{
	"pageid": 4443,
	"ns": 0,
	"title": "Barcelona",
	"index": 1,
	"extract": "Barcelona (/bɑːrsəˈloʊnə/, Catalan: [bəɾsəˈlonə], Spanish: [barθeˈlona]) is the capital city of the autonomous community of Catalonia in the Kingdom of Spain, as well as the country's second most populous municipality, with a population of 1.6 million within city limits. Its urban area extends beyond the administrative city limits with a population of around 4.7 million people, being the sixth-most populous urban area in the European Union after Paris, London, Madrid, the Ruhr area and Milan. It is the largest metropolis on the Mediterranean Sea, located on the coast between the mouths of the rivers Llobregat and Besòs, and bounded to the west by the Serra de Collserola mountain range, the tallest peak of which is 512 metres (1,680 feet) high.\nFounded as a Roman city, in the Middle Ages Barcelona became the capital of the County of Barcelona. After merging with the Kingdom of Aragon, Barcelona continued to be an important city in the Crown of Aragon as an economic and administrative centre of this Crown and the capital of the Principality of Catalonia.",
	"thumbnail": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/Barcelona_collage.JPG/50px-Barcelona_collage.JPG",
		"width": 50,
		"height": 50,
		"original": "https://upload.wikimedia.org/wikipedia/commons/8/8d/Barcelona_collage.JPG"
	},
	"original": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/8/8d/Barcelona_collage.JPG",
		"width": 1540,
		"height": 1540
	},
	"pageimage": "Barcelona_collage.JPG"
}, {
	"pageid": 68187,
	"ns": 0,
	"title": "FC Barcelona",
	"index": 2,
	"extract": "Futbol Club Barcelona (Catalan pronunciation: [fubˈbɔɫ ˈkɫub bərsəˈɫonə]), commonly known as Barcelona and familiarly as Barça, is a professional football club based in Barcelona, Catalonia, Spain.\nFounded in 1899 by a group of Swiss, English and Catalan footballers led by Joan Gamper, the club has become a symbol of Catalan culture and Catalanism, hence the motto \"Més que un club\" (English: \"More than a club\"). Unlike many other football clubs, the supporters own and operate Barcelona. It is the second most valuable sports team in the world, worth $3.56 billion, and the world's second richest football club in terms of revenue, with an annual turnover of €560.8 million. The official Barcelona anthem is the \"Cant del Barça\", written by Jaume Picas and Josep Maria Espinàs.",
	"thumbnail": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/Walter_Wild.jpg/40px-Walter_Wild.jpg",
		"width": 40,
		"height": 50,
		"original": "https://upload.wikimedia.org/wikipedia/commons/2/24/Walter_Wild.jpg"
	},
	"original": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/2/24/Walter_Wild.jpg",
		"width": 810,
		"height": 1020
	},
	"pageimage": "Walter_Wild.jpg"
}, {
	"pageid": 143468,
	"ns": 0,
	"title": "Province of Barcelona",
	"index": 6,
	"extract": "Barcelona (Catalan: [bəɾsəˈɫonə], Spanish: [barθeˈlona]) is a province of eastern Spain, in the center of the autonomous community of Catalonia. The province is bordered by the provinces of Tarragona, Lleida, and Girona, and by the Mediterranean Sea. Its area is 7,733 km². 5,540,925 people live in the province, of whom about 30% (1,621,537) live within the administrative limits of the city of Barcelona, which itself is contained in the Barcelona metropolitan area.\nThe capital of the province is the city of Barcelona, and the provincial council is based in the Casa Serra on the Rambla de Catalunya in that city.",
	"thumbnail": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/thumb/f/fe/Barcelona_in_Spain.svg/50px-Barcelona_in_Spain.svg.png",
		"width": 50,
		"height": 43,
		"original": "https://upload.wikimedia.org/wikipedia/commons/f/fe/Barcelona_in_Spain.svg"
	},
	"original": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/f/fe/Barcelona_in_Spain.svg",
		"width": 1184,
		"height": 1016
	},
	"pageimage": "Barcelona_in_Spain.svg"
}, {
	"pageid": 422013,
	"ns": 0,
	"title": "Count of Barcelona",
	"index": 4,
	"extract": "The Count of Barcelona (Catalan: Comte de Barcelona, Spanish: Conde de Barcelona, Latin: Comites Barcinonenses) was the ruler of Catalonia for much of Catalan history, from the 9th until the 15th century.\n\nThe County of Barcelona was created by Charlemagne after he had conquered lands north of the river Ebro. These lands, called the Marca Hispanica, were partitioned into various counties, of which the Count of Barcelona, usually holding other counties simultaneously, eventually obtained the primacy over the region.\nAs the county became hereditary in one family, the bond of the counts to their Frankish overlords loosened, especially after the Capetian dynasty supplanted the Carolingians.\nIn the 12th century the Counts formed a dynastic union with the Kingdom of Aragon, merging the two realms under a single ruler.",
	"thumbnail": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/Marca_Hispanica_Longnon_806.png/50px-Marca_Hispanica_Longnon_806.png",
		"width": 50,
		"height": 48,
		"original": "https://upload.wikimedia.org/wikipedia/commons/8/8d/Marca_Hispanica_Longnon_806.png"
	},
	"original": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/8/8d/Marca_Hispanica_Longnon_806.png",
		"width": 1448,
		"height": 1404
	},
	"pageimage": "Marca_Hispanica_Longnon_806.png"
}, {
	"pageid": 530955,
	"ns": 0,
	"title": "Barcelona Metro",
	"index": 3,
	"extract": "The Barcelona Metro (Catalan and Spanish: Metro de Barcelona) is an unofficial brand name for an extensive network of rapid transit electrified railway lines that run mostly underground in central Barcelona and into the city's suburbs. It is part of the larger public transport system of Barcelona, the capital of Catalonia (Spain), with unified fares under the Autoritat del Transport Metropolità (ATM) scheme. As of 2014, the network is operated by two separate companies: Transports Metropolitans de Barcelona (TMB) and Ferrocarrils de la Generalitat de Catalunya (FGC). It is made up of 12 lines, combining the lines owned by the two companies. Two lines, L9 and L10 are being built at present, with both lines having different sections of each opened between 2009 and 2016.",
	"thumbnail": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/thumb/f/fa/Metro_Barcelona_train_type_500.jpg/50px-Metro_Barcelona_train_type_500.jpg",
		"width": 50,
		"height": 38,
		"original": "https://upload.wikimedia.org/wikipedia/commons/f/fa/Metro_Barcelona_train_type_500.jpg"
	},
	"original": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/f/fa/Metro_Barcelona_train_type_500.jpg",
		"width": 2272,
		"height": 1704
	},
	"pageimage": "Metro_Barcelona_train_type_500.jpg"
}, {
	"pageid": 1167667,
	"ns": 0,
	"title": "Barcelona S.C.",
	"index": 7,
	"extract": "Barcelona Sporting Club (Spanish pronunciation: [barseˈlona]) is an Ecuadorian sports club based in Guayaquil, known best for its professional football team. They currently play in the Ecuadorian Serie A, the highest level of football in the country, and hold the distinction of being the only club in Ecuadorian history not to be relegated to the Serie B.\nBarcelona is the most successful football team in Ecuador, having won the Serie A title a record 15 times, most recently in 2016. They have also won six regional titles (five in the professional era), and were the first Ecuadorian club to make it to the Copa Libertadores finals, having done so twice.\nBarcelona was founded on May 1, 1925, by Eutimio Pérez, a Spanish immigrant who named the club after his home city of Barcelona. Since then, Barcelona has become the most popular club in the country.",
	"thumbnail": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/thumb/5/59/Soccer.Field_Transparant.png/36px-Soccer.Field_Transparant.png",
		"width": 36,
		"height": 50,
		"original": "https://upload.wikimedia.org/wikipedia/commons/5/59/Soccer.Field_Transparant.png"
	},
	"original": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/5/59/Soccer.Field_Transparant.png",
		"width": 358,
		"height": 493
	},
	"pageimage": "Soccer.Field_Transparant.png"
}, {
	"pageid": 3526295,
	"ns": 0,
	"title": "Port of Barcelona",
	"index": 8,
	"extract": "The Port of Barcelona (Catalan: Port de Barcelona, IPA: [ˈpɔr ðə βərsəˈɫonə]; Spanish: Puerto de Barcelona) has a 2000-year history and great contemporary commercial importance as one of Europe's ports in the Mediterranean, as well as Catalonia's largest port, tying with Tarragona. It is also Spain's third and Europe's ninth largest container port, with a trade volume of 2.57 million TEUs in 2008. The port is managed by the Port Authority of Barcelona. Its 7.86 km2 (3 sq mi) are divided into three zones: Port Vell (the Old Port), the commercial/industrial port, and the logistics port (Barcelona Free Port). The port is undergoing an enlargement that will double its size by diverting the mouth of the Llobregat River 2 km (1.2 mi) to the south and slightly pushing back the Llobregat Delta Nature Reserve.",
	"thumbnail": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/thumb/2/26/BMVB_-_Gaiet%C3%A0_Benavent_i_Rocamora_-_Efecte_de_lluna_al_port_de_Barcelona_-_752.tif/lossy-page1-50px-BMVB_-_Gaiet%C3%A0_Benavent_i_Rocamora_-_Efecte_de_lluna_al_port_de_Barcelona_-_752.tif.jpg",
		"width": 50,
		"height": 32,
		"original": "https://upload.wikimedia.org/wikipedia/commons/2/26/BMVB_-_Gaiet%C3%A0_Benavent_i_Rocamora_-_Efecte_de_lluna_al_port_de_Barcelona_-_752.tif"
	},
	"original": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/2/26/BMVB_-_Gaiet%C3%A0_Benavent_i_Rocamora_-_Efecte_de_lluna_al_port_de_Barcelona_-_752.tif",
		"width": 3299,
		"height": 2094
	},
	"pageimage": "BMVB_-_Gaietà_Benavent_i_Rocamora_-_Efecte_de_lluna_al_port_de_Barcelona_-_752.tif"
}, {
	"pageid": 5169073,
	"ns": 0,
	"title": "Aquarium Barcelona",
	"index": 9,
	"extract": "Aquarium Barcelona (Catalan: Aquàrium de Barcelona, IPA: [əˈkwaɾium də βərsəˈɫonə]) is an aquarium located in Port Vell, a harbor in Barcelona, Catalonia, Spain.\nThe 35 aquariums at the facility are home to 11,000 animals representing 450 species. The aquarium contains a total of 5,000,000 l (1,300,000 US gal). This includes an ocean tank for sharks, rays and other large fish, which is 36 m (118 ft) in diameter, 5 m (16 ft) deep, contains 3,700,000 l (980,000 US gal) of water and has a 80-meter (260 ft) underwater tunnel. The Aquarium of Barcelona is part of the Aspro Parks.",
	"thumbnail": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/Tunnelaquarium_14-05-2009_15-54-09.JPG/50px-Tunnelaquarium_14-05-2009_15-54-09.JPG",
		"width": 50,
		"height": 33,
		"original": "https://upload.wikimedia.org/wikipedia/commons/1/17/Tunnelaquarium_14-05-2009_15-54-09.JPG"
	},
	"original": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/1/17/Tunnelaquarium_14-05-2009_15-54-09.JPG",
		"width": 3872,
		"height": 2592
	},
	"pageimage": "Tunnelaquarium_14-05-2009_15-54-09.JPG"
}, {
	"pageid": 13361439,
	"ns": 0,
	"title": "Barcelona Sants railway station",
	"index": 10,
	"extract": "Barcelona Sants is the main railway station in Barcelona, owned by Adif, the railway infrastructure agency of Spain. It has become the Catalan capital's most important transport hub - being the centre of Rodalies de Catalunya including Barcelona suburban railway services and regional services, as well as the main inter-city station for national and international destinations. The station is named after Sants, the neighbourhood of Barcelona in which it is located. New parts of the station have recently been remodeled to accommodate the Spanish high-speed train AVE in the city, which started serving the city on 20 February 2008. There is also an adjacent international bus station bearing the same name, and a link to the Sants Estació metro station that serves the railway station.",
	"thumbnail": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/thumb/b/bc/Fachada_estaci%C3%B3n_de_Sants.jpg/50px-Fachada_estaci%C3%B3n_de_Sants.jpg",
		"width": 50,
		"height": 38,
		"original": "https://upload.wikimedia.org/wikipedia/commons/b/bc/Fachada_estaci%C3%B3n_de_Sants.jpg"
	},
	"original": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/b/bc/Fachada_estaci%C3%B3n_de_Sants.jpg",
		"width": 800,
		"height": 600
	},
	"pageimage": "Fachada_estación_de_Sants.jpg"
}, {
	"pageid": 18136583,
	"ns": 0,
	"title": "FC Barcelona B",
	"index": 5,
	"extract": "Futbol Club Barcelona B is a Spanish football team based in Barcelona, in the autonomous community of Catalonia.\nFounded in 1970 as FC Barcelona Atlètic, it is the reserve team of FC Barcelona, and currently plays in Segunda División B – Group 3, holding home matches at the Mini Estadi.\nReserve teams in Spain play in the same league system as the senior team, rather than in a reserve team league. They must play at least one level below their main side, and thus Barcelona B are ineligible for promotion to La Liga. They also cannot play in the Copa del Rey.",
	"thumbnail": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/thumb/5/55/Barcelona-Mini_Estadi.jpg/50px-Barcelona-Mini_Estadi.jpg",
		"width": 50,
		"height": 38,
		"original": "https://upload.wikimedia.org/wikipedia/commons/5/55/Barcelona-Mini_Estadi.jpg"
	},
	"original": {
		"source": "https://upload.wikimedia.org/wikipedia/commons/5/55/Barcelona-Mini_Estadi.jpg",
		"width": 640,
		"height": 480
	},
	"pageimage": "Barcelona-Mini_Estadi.jpg"
}];
//

Vue.component('results', {
  props: ['results'],
  template: `
    <div class='block'>
      <div v-if='results.length===0'>
        <h2 class='block__no-results'>No results</h2>
      </div>
      <div v-for='result in results' class='grid__element'>
        <div class='grid__element-block'>
          <a :href="getWikiUrl(result.pageid)" target='_blank'><h1 class='result__title'>{{ result.title }}</h1></a>
          <span class='result__content'>
            <div v-if='result.thumbnail && result.thumbnail.source'>
              <img class='result__image' :src='result.thumbnail.source' :width='result.thumbnail.width' :height='result.thumbnail.width'></img>
            </div>
            <div class='result_extract'>{{ result.extract }}</div>
          </span>
        </div>
      </div>
    </div>`,
    methods: {
      getWikiUrl: function(articleId) {
        return `http://en.wikipedia.org/?curid=${articleId}`;
      }
    }
})

Vue.component('landing', {
  props: ['search'],
  template: `
    <div>
      <h1>Woogle</h1>
      <input v-model="searchinput" type='text' placeholder='Lookup Wiki Article'></input>
      <button v-on:click="search">search</button>
    <a href='https://en.wikipedia.org/wiki/Special:Random' target='_blank'>I'm feeling Wiki</a>
    
    </div>`
})

new Vue({
  el: '#app',
  data: {
    landing: true, // views: landing, or result
    loading: false,
    error: false,
    searchInput: 'Barcelona',
    results: data,
  },
  methods: {
    toggleLanding: function() {
      this.landing = !this.landing;
    },
    search: function() {
      this.error = false;
      this.loading = true;
      const self = this;
      console.log(this.searchInput);
      const url = `https://en.wikipedia.org/w/api.php/w/api.php?action=query&format=json&prop=extracts%7Cpageimages&list=&titles=&generator=search&exsentences=5&exlimit=10&exintro=1&explaintext=1&piprop=thumbnail%7Cname%7Coriginal&pilimit=max&origin=*&gsrsearch=${this.searchInput}`;
      axios.get(url)
      .then(function (response) {
        console.log('response', response);
        if (response.status===200 && response.data.query) {
          const q = response.data.query.pages;
          const results = Object.keys(q).map(k => { return q[k] });
          self.results = results;
          console.log('results,', results, JSON.stringify(results));
        } else {
          self.results = [];
        }
      })
      .catch(function (error) {
        console.log(error);
          self.results = [];
          self.loading = false;
          self.error = true;
      });
      this.landing = false;
    }
  }
})